<!DOCTYPE html>
<html>
<head>
    <style>
        /* Mantenemos la altura fija para evitar el error 'Unknown size value' */
        @page { 
            size: 80mm 297mm; 
            margin: 2mm; 
        }
        
        body { 
            font-family: sans-serif; 
            font-size: 9px;
            line-height: 1.1;
            color: #000;
        }

        /* --- ENCABEZADO SIN BORDES --- */
        .header { 
            text-align: center; 
            border: none; /* Quitamos borde inferior */
            padding-bottom: 3px; 
            margin-bottom: 5px; 
        }
        .header div { margin: 0; padding: 0; border: none; }
        
        .titulo { font-size: 12px; font-weight: bold; margin-bottom: 2px !important; }
        .subtitulo { font-size: 11px; font-weight: bold; margin-top: 2px; }

        /* --- TABLA SIN BORDES --- */
        table { width: 100%; border-collapse: collapse; margin-top: 2px; }
        
        th { 
            text-align: left; 
            border: none; /* Quitamos línea debajo de CNT DESC TOTAL */
            font-size: 8px; 
            font-weight: bold;
            padding-bottom: 2px;
        }
        
        td { 
            padding: 2px 0; 
            vertical-align: top;
            border: none; /* Aseguramos que no haya bordes en celdas */
        }

        .c-cant { width: 10%; text-align: center; }
        .c-desc { width: 60%; }
        .c-tot  { width: 30%; text-align: right; }

        /* Extras */
        .extra {
            font-size: 8px;
            color: #444;
            font-style: italic;
            padding-left: 5px;
        }

        /* --- TOTALES SIN BORDES --- */
        .totales-box {
            margin-top: 5px;
            border: none; /* Quitamos línea superior */
            padding-top: 0;
        }
        .row { display: flex; justify-content: space-between; margin-bottom: 1px; }
        .big { font-size: 14px; font-weight: bold; }
        
        .footer { text-align: center; margin-top: 10px; font-size: 8px; }
    </style>
</head>
<body>
    <div class="header">
        <div class="titulo">ALMUS RESTAURANT</div>
        <div>Rif: J-12345678-9</div>
        <div class="subtitulo">CUENTA MESA #{{ orden.mesa.number }}</div>
        <div>Mesero: {{ orden.mesero.username|upper }}</div>
        <div>{{ fecha|date:"d/m/Y h:i A" }}</div>
    </div>

    <table>
        <thead>
            <tr>
                <th class="c-cant">CNT</th>
                <th class="c-desc">DESC</th>
                <th class="c-tot">TOTAL</th>
            </tr>
        </thead>
        <tbody>
            {% for item in detalles %}
            <tr>
                <td class="c-cant">{{ item.cantidad }}</td>
                <td class="c-desc">
                    {{ item.producto }} <small>({{ item.tamano }})</small>
                    
                    {% if item.extras_elegidos %}
                        {% for extra in item.extras_elegidos %}
                            <div class="extra">+ {{ extra.insumo.nombre }} (${{ extra.precio }})</div>
                        {% endfor %}
                    {% endif %}
                </td>
                <td class="c-tot">
                    ${{ item.subtotal_usd }}<br>
                    {% if item.subtotal_bs > 0 %}
                        <span style="font-size: 8px;">Bs.{{ item.subtotal_bs|floatformat:2 }}</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="totales-box">
        <div class="row">
            <b>SUBTOTAL:</b>
            <b>${{ total_usd }}</b>
        </div>
        
        <div style="text-align: right;">
            <div style="font-size: 10px;">TOTAL A PAGAR:</div>
            <div class="big">${{ total_usd }}</div>
            <div class="big">Bs. {{ total_bs|floatformat:2 }}</div>
        </div>
    </div>

    <div class="footer">
        PROPINA NO INCLUIDA<br>
        ¡Gracias por su visita!
    </div>
</body>
</html>